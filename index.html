<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BEAMOVE ‚Ä¢ Sua Jornada Fitness</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<!-- Icons -->
<script src="https://unpkg.com/lucide@latest"></script>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --bg-primary: #f8fafc;
    --bg-secondary: #ffffff;
    --text-primary: #0f172a;
    --text-secondary: #475569;
    --accent: #8b5cf6;
    --accent-light: #a78bfa;
    --accent-gradient: linear-gradient(135deg, #8b5cf6 0%, #c084fc 100%);
    --success: #10b981;
    --warning: #f59e0b;
    --danger: #ef4444;
    --border: #e2e8f0;
    --card-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.1);
    --hover-shadow: 0 20px 60px -10px rgba(139, 92, 246, 0.3);
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.dark {
    --bg-primary: #0f172a;
    --bg-secondary: #1e293b;
    --text-primary: #f1f5f9;
    --text-secondary: #94a3b8;
    --border: #334155;
    --card-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.5);
}

body {
    font-family: 'Inter', sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    transition: var(--transition);
    line-height: 1.6;
}

/* Login/Register Styles */
.auth-container {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--accent-gradient);
    padding: 20px;
}

.auth-card {
    background: var(--bg-secondary);
    padding: 40px;
    border-radius: 30px;
    width: 100%;
    max-width: 400px;
    box-shadow: var(--card-shadow);
    animation: slideUp 0.5s ease;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.auth-card h2 {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 10px;
    background: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.auth-card input {
    width: 100%;
    padding: 15px;
    margin: 10px 0;
    border: 2px solid var(--border);
    border-radius: 15px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 16px;
    transition: var(--transition);
}

.auth-card input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
}

.btn {
    width: 100%;
    padding: 15px;
    border: none;
    border-radius: 15px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    margin: 10px 0;
}

.btn-primary {
    background: var(--accent-gradient);
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: var(--hover-shadow);
}

.btn-secondary {
    background: var(--bg-primary);
    color: var(--text-primary);
    border: 2px solid var(--border);
}

.btn-secondary:hover {
    border-color: var(--accent);
    color: var(--accent);
}

/* Header */
header {
    background: var(--bg-secondary);
    padding: 20px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(10px);
    background: rgba(var(--bg-secondary-rgb), 0.8);
}

.header-content {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.logo {
    font-size: 28px;
    font-weight: 800;
    background: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: -0.5px;
}

.header-actions {
    display: flex;
    gap: 15px;
}

.icon-btn {
    background: none;
    border: none;
    color: var(--text-primary);
    cursor: pointer;
    padding: 8px;
    border-radius: 12px;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 8px;
}

.icon-btn:hover {
    background: var(--bg-primary);
    color: var(--accent);
}

/* Cards de Produtos */
.products-section {
    max-width: 1200px;
    margin: 30px auto;
    padding: 0 20px;
}

.section-title {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.featured-card {
    background: var(--accent-gradient);
    border-radius: 30px;
    padding: 30px;
    color: white;
    margin-bottom: 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 20px;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { box-shadow: 0 10px 40px -10px rgba(139, 92, 246, 0.3); }
    50% { box-shadow: 0 20px 60px -10px rgba(139, 92, 246, 0.6); }
    100% { box-shadow: 0 10px 40px -10px rgba(139, 92, 246, 0.3); }
}

.featured-card h3 {
    font-size: 28px;
    font-weight: 700;
    margin-bottom: 10px;
}

.featured-card p {
    opacity: 0.9;
    margin-bottom: 20px;
}

.featured-card .btn {
    width: auto;
    padding: 15px 40px;
    background: white;
    color: var(--accent);
    margin: 0;
}

.featured-card .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

.products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
    margin-bottom: 40px;
}

.product-card {
    background: var(--bg-secondary);
    border-radius: 25px;
    padding: 25px;
    box-shadow: var(--card-shadow);
    transition: var(--transition);
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

.product-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 5px;
    background: var(--accent-gradient);
    transform: scaleX(0);
    transition: var(--transition);
}

.product-card:hover::before {
    transform: scaleX(1);
}

.product-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--hover-shadow);
}

.product-icon {
    width: 60px;
    height: 60px;
    background: var(--accent-gradient);
    border-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 20px;
    color: white;
}

.product-card h4 {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 10px;
}

.product-card p {
    color: var(--text-secondary);
    margin-bottom: 20px;
    font-size: 14px;
}

.product-price {
    font-size: 24px;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 15px;
}

.product-badge {
    position: absolute;
    top: 20px;
    right: 20px;
    background: var(--success);
    color: white;
    padding: 5px 15px;
    border-radius: 50px;
    font-size: 12px;
    font-weight: 600;
}

/* Feed de Conte√∫do */
.feed-container {
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
}

.stories {
    display: flex;
    gap: 15px;
    overflow-x: auto;
    padding: 10px 0;
    margin-bottom: 20px;
    scrollbar-width: none;
}

.stories::-webkit-scrollbar {
    display: none;
}

.story-item {
    min-width: 80px;
    text-align: center;
    cursor: pointer;
}

.story-circle {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: var(--accent-gradient);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 8px;
    border: 3px solid var(--bg-secondary);
    transition: var(--transition);
}

.story-item:hover .story-circle {
    transform: scale(1.05);
}

.story-circle span {
    color: white;
    font-weight: 600;
    font-size: 24px;
}

.story-label {
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary);
}

.create-post {
    background: var(--bg-secondary);
    border-radius: 20px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: var(--card-shadow);
}

.create-post textarea {
    width: 100%;
    padding: 15px;
    border: 2px solid var(--border);
    border-radius: 15px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 16px;
    resize: none;
    margin-bottom: 15px;
}

.post-card {
    background: var(--bg-secondary);
    border-radius: 20px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: var(--card-shadow);
    animation: fadeIn 0.5s ease;
}

.post-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 15px;
}

.post-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--accent-gradient);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 20px;
}

.post-info h4 {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 4px;
}

.post-info span {
    font-size: 12px;
    color: var(--text-secondary);
}

.post-content {
    margin-bottom: 15px;
    line-height: 1.6;
}

.post-actions {
    display: flex;
    gap: 20px;
    border-top: 1px solid var(--border);
    padding-top: 15px;
}

.post-action {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--text-secondary);
    cursor: pointer;
    transition: var(--transition);
}

.post-action:hover {
    color: var(--accent);
}

/* Chat */
.chat-container {
    max-width: 800px;
    margin: 20px auto;
    padding: 20px;
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: 20px;
    height: calc(100vh - 140px);
}

.chat-sidebar {
    background: var(--bg-secondary);
    border-radius: 25px;
    padding: 20px;
    box-shadow: var(--card-shadow);
}

.chat-sidebar h3 {
    margin-bottom: 20px;
    font-size: 18px;
}

.chat-users {
    list-style: none;
}

.chat-user {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    border-radius: 15px;
    cursor: pointer;
    transition: var(--transition);
    margin-bottom: 5px;
}

.chat-user:hover {
    background: var(--bg-primary);
}

.chat-user.active {
    background: var(--accent);
    color: white;
}

.chat-user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--accent-gradient);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
}

.chat-main {
    background: var(--bg-secondary);
    border-radius: 25px;
    display: flex;
    flex-direction: column;
    box-shadow: var(--card-shadow);
    overflow: hidden;
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.message {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    max-width: 80%;
}

.message.sent {
    align-self: flex-end;
    flex-direction: row-reverse;
}

.message-avatar {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    background: var(--accent-gradient);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 14px;
    font-weight: 600;
    flex-shrink: 0;
}

.message-content {
    background: var(--bg-primary);
    padding: 12px 15px;
    border-radius: 20px;
    position: relative;
}

.message.sent .message-content {
    background: var(--accent);
    color: white;
}

.message-content p {
    margin-bottom: 5px;
}

.message-time {
    font-size: 10px;
    opacity: 0.7;
}

.chat-input {
    padding: 20px;
    border-top: 1px solid var(--border);
    display: flex;
    gap: 10px;
}

.chat-input input {
    flex: 1;
    padding: 15px;
    border: 2px solid var(--border);
    border-radius: 25px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 16px;
}

.chat-input button {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--accent-gradient);
    border: none;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.chat-input button:hover {
    transform: scale(1.1);
}

/* Perfil */
.profile-container {
    max-width: 1000px;
    margin: 30px auto;
    padding: 0 20px;
}

.profile-header {
    background: var(--bg-secondary);
    border-radius: 30px;
    padding: 40px;
    box-shadow: var(--card-shadow);
    margin-bottom: 30px;
    position: relative;
    overflow: hidden;
}

.profile-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 150px;
    background: var(--accent-gradient);
    opacity: 0.1;
}

.profile-cover {
    position: relative;
    height: 200px;
    background: var(--accent-gradient);
    border-radius: 20px;
    margin-bottom: 70px;
}

.profile-avatar-large {
    width: 130px;
    height: 130px;
    border-radius: 50%;
    background: var(--accent-gradient);
    border: 5px solid var(--bg-secondary);
    position: absolute;
    bottom: -65px;
    left: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 50px;
    font-weight: 700;
    box-shadow: var(--card-shadow);
}

.profile-info {
    margin-top: 30px;
}

.profile-name {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 5px;
}

.profile-bio {
    color: var(--text-secondary);
    margin-bottom: 20px;
    max-width: 500px;
}

.profile-stats {
    display: flex;
    gap: 30px;
    margin-bottom: 20px;
}

.stat-item {
    text-align: center;
}

.stat-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--accent);
}

.stat-label {
    font-size: 14px;
    color: var(--text-secondary);
}

.profile-edit-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    padding: 12px 24px;
    background: var(--accent-gradient);
    color: white;
    border: none;
    border-radius: 50px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 8px;
}

.profile-edit-btn:hover {
    transform: translateY(-2px);
    box-shadow: var(--hover-shadow);
}

.edit-profile-form {
    background: var(--bg-secondary);
    border-radius: 30px;
    padding: 30px;
    margin-top: 20px;
    animation: slideDown 0.3s ease;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.edit-profile-form input,
.edit-profile-form textarea {
    width: 100%;
    padding: 15px;
    margin: 10px 0;
    border: 2px solid var(--border);
    border-radius: 15px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 16px;
}

.edit-profile-form textarea {
    min-height: 100px;
    resize: vertical;
}

/* Navigation */
.bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: var(--bg-secondary);
    padding: 15px 30px;
    display: flex;
    justify-content: space-around;
    align-items: center;
    box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.05);
    backdrop-filter: blur(10px);
    background: rgba(var(--bg-secondary-rgb), 0.9);
    z-index: 100;
}

.nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    color: var(--text-secondary);
    cursor: pointer;
    transition: var(--transition);
    position: relative;
    padding: 8px 16px;
    border-radius: 50px;
}

.nav-item.active {
    color: var(--accent);
    background: var(--bg-primary);
}

.nav-item i {
    font-size: 24px;
}

.nav-item span {
    font-size: 12px;
    font-weight: 500;
}

.nav-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background: var(--danger);
    color: white;
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 50px;
}

/* Forum Styles */
.forum-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.forum-title {
    font-size: 24px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 10px;
}

.forum-add-btn {
    background: var(--accent-gradient);
    color: white;
    border: none;
    border-radius: 50px;
    padding: 12px 24px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 8px;
}

.forum-add-btn:hover {
    transform: translateY(-2px);
    box-shadow: var(--hover-shadow);
}

.forum-posts {
    margin-top: 20px;
}

.forum-post {
    background: var(--bg-secondary);
    border-radius: 20px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: var(--card-shadow);
}

.forum-post-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 15px;
}

.forum-post-author {
    font-weight: 600;
}

.forum-post-date {
    font-size: 12px;
    color: var(--text-secondary);
}

.forum-post-content {
    margin-bottom: 15px;
    line-height: 1.6;
}

.forum-post-footer {
    display: flex;
    gap: 20px;
    border-top: 1px solid var(--border);
    padding-top: 15px;
}

.back-btn {
    background: none;
    border: none;
    color: var(--accent);
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 5px;
    margin-bottom: 20px;
    padding: 10px 0;
}

/* Utilit√°rios */
.hidden {
    display: none !important;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    padding-bottom: 100px;
}

/* Responsividade */
@media (max-width: 768px) {
    .chat-container {
        grid-template-columns: 1fr;
    }
    
    .chat-sidebar {
        display: none;
    }
    
    .featured-card {
        flex-direction: column;
        text-align: center;
    }
    
    .featured-card .btn {
        width: 100%;
    }
    
    .profile-header {
        padding: 20px;
    }
    
    .profile-avatar-large {
        left: 20px;
        width: 100px;
        height: 100px;
        font-size: 40px;
    }
}
</style>
</head>

<body>

<!-- Login Screen -->
<div id="loginScreen" class="auth-container">
    <div class="auth-card">
        <h2>BEAMOVE</h2>
        <p style="margin-bottom: 30px; color: var(--text-secondary);">Fa√ßa login para continuar</p>
        <input type="email" id="loginEmail" placeholder="Seu email">
        <input type="password" id="loginPassword" placeholder="Sua senha">
        <button class="btn btn-primary" onclick="login()">Entrar</button>
        <button class="btn btn-secondary" onclick="showRegister()">Criar nova conta</button>
    </div>
</div>

<!-- Register Screen -->
<div id="registerScreen" class="auth-container hidden">
    <div class="auth-card">
        <h2>Criar Conta</h2>
        <p style="margin-bottom: 30px; color: var(--text-secondary);">Comece sua jornada fitness</p>
        <input type="text" id="username" placeholder="@usuario">
        <input type="email" id="registerEmail" placeholder="Email">
        <input type="password" id="registerPassword" placeholder="Senha">
        <button class="btn btn-primary" onclick="register()">Cadastrar</button>
        <button class="btn btn-secondary" onclick="showLogin()">Voltar ao login</button>
    </div>
</div>

<!-- Main App -->
<div id="appScreen" class="hidden">
    <header>
        <div class="header-content">
            <div class="logo">BEAMOVE</div>
            <div class="header-actions">
                <button class="icon-btn" onclick="toggleDark()">
                    <i data-lucide="moon"></i>
                </button>
                <button class="icon-btn" onclick="logout()">
                    <i data-lucide="log-out"></i>
                    <span>Sair</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Home Section -->
    <div id="home" class="container">
        <!-- Stories (Instagram Style) -->
        <div class="stories">
            <div class="story-item" onclick="openForum('treino')">
                <div class="story-circle">
                    <span>üí™</span>
                </div>
                <span class="story-label">Treino</span>
            </div>
            <div class="story-item" onclick="openForum('receitas')">
                <div class="story-circle">
                    <span>ü•ó</span>
                </div>
                <span class="story-label">Receitas</span>
            </div>
            <div class="story-item" onclick="openForum('yoga')">
                <div class="story-circle">
                    <span>üßò</span>
                </div>
                <span class="story-label">Yoga</span>
            </div>
            <div class="story-item" onclick="openForum('dicas')">
                <div class="story-circle">
                    <span>üìö</span>
                </div>
                <span class="story-label">Dicas</span>
            </div>
        </div>

        <!-- Featured Product Card -->
        <div class="featured-card">
            <div>
                <h3>ü•ó Acompanhamento Nutricional</h3>
                <p>Planos personalizados com nutricionistas especializados</p>
                <div style="display: flex; gap: 15px;">
                    <button class="btn" onclick="window.open('https://hotmart.com', '_blank')">Comprar via Hotmart</button>
                    <button class="btn" onclick="window.open('https://kiwify.com', '_blank')">Comprar via Kiwify</button>
                </div>
            </div>
            <i data-lucide="apple" style="width: 80px; height: 80px; opacity: 0.5;"></i>
        </div>

        <!-- Products Grid -->
        <h2 class="section-title">
            <i data-lucide="package"></i>
            Nossos Produtos
        </h2>
        <div class="products-grid">
            <div class="product-card">
                <div class="product-badge">Novo</div>
                <div class="product-icon">
                    <i data-lucide="activity"></i>
                </div>
                <h4>Yoga para Iniciantes</h4>
                <p>Curso completo de yoga para todos os n√≠veis</p>
                <div class="product-price">R$ 97,00</div>
                <button class="btn btn-primary" onclick="window.open('https://hotmart.com', '_blank')">Comprar</button>
            </div>

            <div class="product-card">
                <div class="product-icon">
                    <i data-lucide="flame"></i>
                </div>
                <h4>Emagrecimento Total</h4>
                <p>Programa completo para queima de gordura</p>
                <div class="product-price">R$ 147,00</div>
                <button class="btn btn-primary" onclick="window.open('https://hotmart.com', '_blank')">Comprar</button>
            </div>

            <div class="product-card">
                <div class="product-icon">
                    <i data-lucide="book-open"></i>
                </div>
                <h4>E-books Fitness</h4>
                <p>Guias pr√°ticos para sua transforma√ß√£o</p>
                <div class="product-price">R$ 37,00</div>
                <button class="btn btn-primary" onclick="window.open('https://kiwify.com', '_blank')">Comprar</button>
            </div>
        </div>

        <!-- Feed -->
        <div class="create-post">
            <textarea id="postInput" placeholder="Compartilhe sua evolu√ß√£o..."></textarea>
            <button class="btn btn-primary" onclick="addPost()">Publicar</button>
        </div>
        <div id="feed"></div>
    </div>

    <!-- Forum Section (Dynamic) -->
    <div id="forum" class="container hidden">
        <button class="back-btn" onclick="backToHome()">
            <i data-lucide="arrow-left"></i>
            Voltar
        </button>
        
        <div class="forum-header">
            <h2 class="forum-title" id="forumTitle">
                <i data-lucide="dumbbell" id="forumIcon"></i>
                <span id="forumName">Treino</span>
            </h2>
            <button class="forum-add-btn" onclick="showAddForumPost()">
                <i data-lucide="plus"></i>
                Adicionar
            </button>
        </div>

        <!-- Add Forum Post Form -->
        <div id="addForumPostForm" class="create-post hidden">
            <textarea id="forumPostInput" placeholder="Compartilhe sua dica..."></textarea>
            <button class="btn btn-primary" onclick="addForumPost()">Publicar</button>
            <button class="btn btn-secondary" onclick="hideAddForumPost()">Cancelar</button>
        </div>

        <!-- Forum Posts -->
        <div id="forumPosts" class="forum-posts"></div>
    </div>

    <!-- Chat Section -->
    <div id="chat" class="hidden">
        <div class="chat-container">
            <div class="chat-sidebar">
                <h3>Conversas</h3>
                <ul class="chat-users" id="chatUsersList">
                    <li class="chat-user active">
                        <div class="chat-user-avatar">G</div>
                        <div>
                            <strong>Geral</strong>
                            <span style="font-size: 12px; display: block;">Todos os membros</span>
                        </div>
                    </li>
                </ul>
            </div>
            
            <div class="chat-main">
                <div class="chat-messages" id="chatBox"></div>
                <div class="chat-input">
                    <input type="text" id="chatInput" placeholder="Digite sua mensagem...">
                    <button onclick="sendMessage()">
                        <i data-lucide="send"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Section -->
    <div id="profile" class="hidden">
        <div class="profile-container">
            <div class="profile-header">
                <div class="profile-cover"></div>
                <div class="profile-avatar-large" id="profileAvatar"></div>
                
                <button class="profile-edit-btn" onclick="toggleEditProfile()">
                    <i data-lucide="edit-2"></i>
                    Editar Perfil
                </button>
                
                <div class="profile-info">
                    <h1 class="profile-name" id="profileUsername"></h1>
                    <p class="profile-bio" id="profileBio"></p>
                    
                    <div class="profile-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="profilePosts">0</div>
                            <div class="stat-label">Posts</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="profileFollowers">0</div>
                            <div class="stat-label">Seguidores</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="profileFollowing">0</div>
                            <div class="stat-label">Seguindo</div>
                        </div>
                    </div>
                    
                    <a id="profileLink" target="_blank" style="color: var(--accent); text-decoration: none;">üåê website</a>
                </div>
            </div>

            <!-- Edit Profile Form -->
            <div id="editProfileForm" class="edit-profile-form hidden">
                <h3 style="margin-bottom: 20px;">Editar Perfil</h3>
                <input type="text" id="editName" placeholder="Seu nome">
                <textarea id="editBio" maxlength="200" placeholder="Bio (200 caracteres)"></textarea>
                <input type="text" id="editLink" placeholder="Link do seu site">
                <button class="btn btn-primary" onclick="saveProfile()">Salvar Altera√ß√µes</button>
                <button class="btn btn-secondary" onclick="toggleEditProfile()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="showTab('home')">
            <i data-lucide="home"></i>
            <span>In√≠cio</span>
        </div>
        <div class="nav-item" onclick="showTab('chat')">
            <i data-lucide="message-circle"></i>
            <span>Chat</span>
        </div>
        <div class="nav-item" onclick="showTab('profile')">
            <i data-lucide="user"></i>
            <span>Perfil</span>
        </div>
    </nav>
</div>

<script>
// Initialize Lucide icons
lucide.createIcons();

// Firebase Config
const firebaseConfig = {
    apiKey: "AIzaSyBdIH1kKv_e4f25nubgQ9ED8hyfl-3FmbM",
    authDomain: "beamove-pro.firebaseapp.com",
    projectId: "beamove-pro",
    storageBucket: "beamove-pro.firebasestorage.app",
    messagingSenderId: "816563837877",
    appId: "1:816563837877:web:7d812c57fecc0338f117fc"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Current forum category
let currentForum = 'treino';

// Auth State Observer
auth.onAuthStateChanged(user => {
    if (user) {
        document.getElementById('loginScreen').classList.add('hidden');
        document.getElementById('registerScreen').classList.add('hidden');
        document.getElementById('appScreen').classList.remove('hidden');
        
        loadFeed();
        loadChat();
        loadProfile();
        loadUsersList();
    } else {
        document.getElementById('loginScreen').classList.remove('hidden');
        document.getElementById('appScreen').classList.add('hidden');
    }
});

// Register - CORRIGIDA COM TRATAMENTO DE PERMISS√ÉO
function register() {
    const username = document.getElementById('username').value.trim();
    const email = document.getElementById('registerEmail').value;
    const password = document.getElementById('registerPassword').value;
    
    if (!username) {
        alert('Por favor, preencha o nome de usu√°rio');
        return;
    }
    
    if (!username.startsWith('@')) {
        alert('Username deve come√ßar com @');
        return;
    }
    
    if (!email || !password) {
        alert('Por favor, preencha todos os campos');
        return;
    }
    
    // Mostrar mensagem de carregamento
    const btn = event.target;
    const originalText = btn.innerText;
    btn.innerText = 'Cadastrando...';
    btn.disabled = true;
    
    // Verificar se username j√° existe
    db.collection('users').where('username', '==', username).get()
        .then(snapshot => {
            if (!snapshot.empty) {
                throw new Error('Username j√° existe');
            }
            
            // Criar usu√°rio
            return auth.createUserWithEmailAndPassword(email, password);
        })
        .then(userCredential => {
            // Tentar criar documento do usu√°rio
            return db.collection('users').doc(userCredential.user.uid).set({
                username: username,
                email: email,
                bio: '',
                link: '',
                name: username,
                createdAt: new Date()
            }).then(() => {
                return userCredential;
            }).catch(error => {
                // Se falhar ao criar documento, fazer logout e mostrar erro
                if (error.code === 'permission-denied') {
                    userCredential.user.delete().catch(() => {});
                    throw new Error('Erro de permiss√£o no Firestore. Verifique as regras do banco de dados.');
                }
                throw error;
            });
        })
        .then(userCredential => {
            alert('Conta criada com sucesso!');
            showLogin();
        })
        .catch(error => {
            // Restaurar bot√£o
            btn.innerText = originalText;
            btn.disabled = false;
            
            // Tratar erros espec√≠ficos
            if (error.message === 'Username j√° existe') {
                alert('Este nome de usu√°rio j√° est√° em uso');
            } else if (error.code === 'auth/email-already-in-use') {
                alert('Este email j√° est√° sendo usado');
            } else if (error.code === 'auth/weak-password') {
                alert('A senha deve ter pelo menos 6 caracteres');
            } else if (error.code === 'auth/invalid-email') {
                alert('Email inv√°lido');
            } else if (error.message.includes('permiss√£o')) {
                alert('Erro de permiss√£o no banco de dados. Por favor, configure as regras do Firestore conforme instru√ß√µes.');
                console.error('Erro de permiss√£o:', error);
            } else {
                alert('Erro ao criar conta: ' + (error.message || error));
                console.error('Erro completo:', error);
            }
        });
}

// Login
function login() {
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    
    auth.signInWithEmailAndPassword(email, password)
        .catch(error => {
            alert(error.message);
        });
}

// Logout
function logout() {
    auth.signOut();
}

// Show Register Screen
function showRegister() {
    document.getElementById('loginScreen').classList.add('hidden');
    document.getElementById('registerScreen').classList.remove('hidden');
}

// Show Login Screen
function showLogin() {
    document.getElementById('registerScreen').classList.add('hidden');
    document.getElementById('loginScreen').classList.remove('hidden');
}

// Toggle Dark Mode
function toggleDark() {
    document.body.classList.toggle('dark');
    lucide.createIcons();
}

// Show Tab
function showTab(tabName) {
    // Hide all sections
    document.getElementById('home').classList.add('hidden');
    document.getElementById('chat').classList.add('hidden');
    document.getElementById('profile').classList.add('hidden');
    document.getElementById('forum').classList.add('hidden');
    
    // Show selected section
    document.getElementById(tabName).classList.remove('hidden');
    
    // Update nav active state
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
    });
    event.currentTarget.classList.add('active');
    
    // Refresh icons
    lucide.createIcons();
}

// Open Forum
function openForum(category) {
    currentForum = category;
    
    // Update forum title and icon
    const titles = {
        'treino': { name: 'Treino', icon: 'dumbbell' },
        'receitas': { name: 'Receitas', icon: 'utensils' },
        'yoga': { name: 'Yoga', icon: 'activity' },
        'dicas': { name: 'Dicas', icon: 'book-open' }
    };
    
    document.getElementById('forumName').innerText = titles[category].name;
    document.getElementById('forumIcon').setAttribute('data-lucide', titles[category].icon);
    
    // Hide home and show forum
    document.getElementById('home').classList.add('hidden');
    document.getElementById('forum').classList.remove('hidden');
    
    // Update nav active state
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
    });
    
    // Load forum posts
    loadForumPosts();
    
    // Refresh icons
    lucide.createIcons();
}

// Back to Home
function backToHome() {
    document.getElementById('forum').classList.add('hidden');
    document.getElementById('home').classList.remove('hidden');
    
    // Update nav active state
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
    });
    document.querySelector('.nav-item:first-child').classList.add('active');
    
    // Refresh icons
    lucide.createIcons();
}

// Show Add Forum Post Form
function showAddForumPost() {
    document.getElementById('addForumPostForm').classList.remove('hidden');
}

// Hide Add Forum Post Form
function hideAddForumPost() {
    document.getElementById('addForumPostForm').classList.add('hidden');
    document.getElementById('forumPostInput').value = '';
}

// Add Forum Post - CORRIGIDA E TESTADA
function addForumPost() {
    const postInput = document.getElementById('forumPostInput');
    const postText = postInput.value.trim();
    
    if (!postText) {
        alert('Por favor, digite algo para publicar');
        return;
    }
    
    if (!auth.currentUser) {
        alert('Voc√™ precisa estar logado');
        return;
    }
    
    console.log('Tentando publicar post na categoria:', currentForum);
    console.log('Texto:', postText);
    console.log('Usu√°rio:', auth.currentUser.uid);
    
    // Desabilitar bot√£o para evitar duplicatas
    const btn = event.target;
    const originalText = btn.innerText;
    btn.innerText = 'Publicando...';
    btn.disabled = true;
    
    // Criar objeto do post com timestamp atual
    const postData = {
        text: postText,
        userId: auth.currentUser.uid,
        user: auth.currentUser.uid,
        category: currentForum,
        created: new Date(),
        likes: 0,
        comments: 0
    };
    
    console.log('Dados do post:', postData);
    
    // Adicionar post ao Firestore
    db.collection('forum_posts').add(postData)
    .then((docRef) => {
        console.log('Post criado com sucesso! ID:', docRef.id);
        
        // Limpar formul√°rio
        postInput.value = '';
        hideAddForumPost();
        
        // Mostrar mensagem de sucesso
        alert('Post publicado com sucesso!');
        
        // Carregar posts imediatamente - sem usar orderBy para evitar √≠ndice
        loadForumPostsSimple();
    })
    .catch(error => {
        console.error('ERRO ao publicar:', error);
        console.error('C√≥digo do erro:', error.code);
        console.error('Mensagem:', error.message);
        alert('Erro ao publicar: ' + error.message + '\n\nVerifique o console para mais detalhes (F12)');
    })
    .finally(() => {
        btn.innerText = originalText;
        btn.disabled = false;
    });
}

// Load Forum Posts - VERS√ÉO SIMPLIFICADA SEM ORDERBY
function loadForumPostsSimple() {
    if (!auth.currentUser) {
        console.log('Usu√°rio n√£o logado, n√£o carregando posts');
        return;
    }
    
    console.log('Carregando posts para categoria:', currentForum);
    
    // Mostrar loading
    const forumPosts = document.getElementById('forumPosts');
    forumPosts.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-secondary);">Carregando posts...</div>';
    
    // Consulta sem orderBy para n√£o precisar de √≠ndice
    db.collection('forum_posts')
        .where('category', '==', currentForum)
        .get()
        .then(async (querySnapshot) => {
            console.log('Posts encontrados:', querySnapshot.size);
            
            if (querySnapshot.empty) {
                forumPosts.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-secondary);">Nenhum post ainda. Seja o primeiro a compartilhar! üìù</div>';
                return;
            }
            
            // Array para armazenar posts com dados do usu√°rio
            const postsArray = [];
            
            // Para cada documento, buscar dados do usu√°rio
            for (const doc of querySnapshot.docs) {
                const post = doc.data();
                const postId = doc.id;
                
                try {
                    const userDoc = await db.collection('users').doc(post.user).get();
                    let username = '@usuario';
                    
                    if (userDoc.exists) {
                        username = userDoc.data().username || '@usuario';
                    }
                    
                    postsArray.push({
                        postId,
                        post,
                        username
                    });
                } catch (error) {
                    console.error('Erro ao buscar usu√°rio:', error);
                    postsArray.push({
                        postId,
                        post,
                        username: '@usuario'
                    });
                }
            }
            
            // Ordenar por data manualmente (mais recente primeiro)
            postsArray.sort((a, b) => {
                const dateA = a.post.created ? new Date(a.post.created.seconds * 1000) : new Date(0);
                const dateB = b.post.created ? new Date(b.post.created.seconds * 1000) : new Date(0);
                return dateB - dateA;
            });
            
            // Limpar e renderizar
            forumPosts.innerHTML = '';
            
            postsArray.forEach(item => {
                const postElement = document.createElement('div');
                postElement.className = 'forum-post';
                postElement.innerHTML = `
                    <div class="forum-post-header">
                        <div class="post-avatar">${item.username ? item.username.charAt(1).toUpperCase() : 'U'}</div>
                        <div>
                            <div class="forum-post-author">${item.username}</div>
                            <div class="forum-post-date">${formatDate(item.post.created)}</div>
                        </div>
                    </div>
                    <div class="forum-post-content">${item.post.text}</div>
                    <div class="forum-post-footer">
                        <div class="post-action" onclick="likeForumPost('${item.postId}')">
                            <i data-lucide="heart"></i>
                            <span>${item.post.likes || 0}</span>
                        </div>
                        <div class="post-action" onclick="commentForumPost('${item.postId}')">
                            <i data-lucide="message-circle"></i>
                            <span>${item.post.comments || 0}</span>
                        </div>
                    </div>
                `;
                forumPosts.appendChild(postElement);
            });
            
            lucide.createIcons();
        })
        .catch(error => {
            console.error('ERRO ao carregar posts:', error);
            console.error('C√≥digo:', error.code);
            console.error('Mensagem:', error.message);
            forumPosts.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--danger);">Erro ao carregar posts. Verifique o console (F12)</div>';
        });
}

// Alias para manter compatibilidade
function loadForumPosts() {
    loadForumPostsSimple();
}

// Like Forum Post
function likeForumPost(postId) {
    const postRef = db.collection('forum_posts').doc(postId);
    
    postRef.get().then(doc => {
        if (doc.exists) {
            const likes = (doc.data().likes || 0) + 1;
            postRef.update({ likes: likes });
        }
    }).catch(error => {
        console.error('Erro ao dar like:', error);
    });
}

// Comment Forum Post
function commentForumPost(postId) {
    alert('Funcionalidade de coment√°rios em breve!');
}

// Load Feed
function loadFeed() {
    db.collection('posts').orderBy('created', 'desc')
        .onSnapshot(snapshot => {
            const feed = document.getElementById('feed');
            feed.innerHTML = '';
            
            if (snapshot.empty) {
                feed.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-secondary);">Nenhum post no feed ainda. Compartilhe algo! üì±</div>';
                return;
            }
            
            snapshot.forEach(async doc => {
                const post = doc.data();
                try {
                    const userDoc = await db.collection('users').doc(post.user).get();
                    const userData = userDoc.exists ? userDoc.data() : { username: '@usuario' };
                    
                    const postElement = document.createElement('div');
                    postElement.className = 'post-card';
                    postElement.innerHTML = `
                        <div class="post-header">
                            <div class="post-avatar">${userData.username ? userData.username.charAt(1).toUpperCase() : 'U'}</div>
                            <div class="post-info">
                                <h4>${userData.username || '@usuario'}</h4>
                                <span>${formatDate(post.created)}</span>
                            </div>
                        </div>
                        <div class="post-content">${post.text}</div>
                        <div class="post-actions">
                            <div class="post-action" onclick="likePost('${doc.id}')">
                                <i data-lucide="heart"></i>
                                <span>${post.likes || 0}</span>
                            </div>
                            <div class="post-action" onclick="commentPost('${doc.id}')">
                                <i data-lucide="message-circle"></i>
                                <span>${post.comments || 0}</span>
                            </div>
                            <div class="post-action" onclick="sharePost('${doc.id}')">
                                <i data-lucide="share-2"></i>
                            </div>
                        </div>
                    `;
                    feed.appendChild(postElement);
                } catch (error) {
                    console.error('Erro ao carregar post do feed:', error);
                }
            });
            
            lucide.createIcons();
        });
}

// Add Post
function addPost() {
    const postInput = document.getElementById('postInput');
    const postText = postInput.value.trim();
    
    if (!postText) {
        alert('Por favor, digite algo para publicar');
        return;
    }
    
    const btn = event.target;
    const originalText = btn.innerText;
    btn.innerText = 'Publicando...';
    btn.disabled = true;
    
    db.collection('posts').add({
        text: postText,
        user: auth.currentUser.uid,
        created: new Date(),
        likes: 0,
        comments: 0
    })
    .then(() => {
        postInput.value = '';
        alert('Post publicado com sucesso!');
    })
    .catch(error => {
        console.error('Erro ao publicar:', error);
        alert('Erro ao publicar: ' + error.message);
    })
    .finally(() => {
        btn.innerText = originalText;
        btn.disabled = false;
    });
}

// Load Chat
function loadChat() {
    db.collection('chat').orderBy('created')
        .onSnapshot(async snapshot => {
            const chatBox = document.getElementById('chatBox');
            chatBox.innerHTML = '';
            
            for (const doc of snapshot.docs) {
                const message = doc.data();
                try {
                    const userDoc = await db.collection('users').doc(message.user).get();
                    const userData = userDoc.exists ? userDoc.data() : { username: '@usuario' };
                    
                    const messageElement = document.createElement('div');
                    messageElement.className = message.user === auth.currentUser.uid ? 'message sent' : 'message';
                    messageElement.innerHTML = `
                        <div class="message-avatar">${userData.username ? userData.username.charAt(1).toUpperCase() : 'U'}</div>
                        <div class="message-content">
                            <p>${message.text}</p>
                            <span class="message-time">${formatDate(message.created)}</span>
                        </div>
                    `;
                    chatBox.appendChild(messageElement);
                } catch (error) {
                    console.error('Erro ao carregar mensagem:', error);
                }
            }
            
            // Scroll to bottom
            chatBox.scrollTop = chatBox.scrollHeight;
        });
}

// Send Message
function sendMessage() {
    const chatInput = document.getElementById('chatInput');
    const messageText = chatInput.value.trim();
    
    if (!messageText) return;
    
    db.collection('chat').add({
        text: messageText,
        user: auth.currentUser.uid,
        created: new Date()
    })
    .then(() => {
        chatInput.value = '';
    })
    .catch(error => {
        console.error('Erro ao enviar mensagem:', error);
        alert('Erro ao enviar mensagem: ' + error.message);
    });
}

// Load Users List
function loadUsersList() {
    db.collection('users').onSnapshot(snapshot => {
        const usersList = document.getElementById('chatUsersList');
        usersList.innerHTML = '<li class="chat-user active"><div class="chat-user-avatar">G</div><div><strong>Geral</strong><span style="font-size: 12px; display: block;">Todos os membros</span></div></li>';
        
        snapshot.forEach(doc => {
            if (doc.id !== auth.currentUser.uid) {
                const user = doc.data();
                const userElement = document.createElement('li');
                userElement.className = 'chat-user';
                userElement.onclick = () => startPrivateChat(doc.id, user.username);
                userElement.innerHTML = `
                    <div class="chat-user-avatar">${user.username ? user.username.charAt(1).toUpperCase() : 'U'}</div>
                    <div>
                        <strong>${user.username || '@usuario'}</strong>
                        <span style="font-size: 12px; display: block;">Membro</span>
                    </div>
                `;
                usersList.appendChild(userElement);
            }
        });
    });
}

// Start Private Chat
function startPrivateChat(userId, username) {
    alert(`Iniciando chat privado com ${username} (Em breve dispon√≠vel!)`);
}

// Load Profile
function loadProfile() {
    const user = auth.currentUser;
    
    db.collection('users').doc(user.uid).get()
        .then(doc => {
            const data = doc.data();
            document.getElementById('profileUsername').innerText = data.username || '@usuario';
            document.getElementById('profileBio').innerText = data.bio || 'Ol√°, estou usando BEAMOVE! üí™';
            document.getElementById('profileLink').innerText = data.link || 'Adicione seu link';
            document.getElementById('profileLink').href = data.link || '#';
            document.getElementById('profileAvatar').innerText = data.username ? data.username.charAt(1).toUpperCase() : 'U';
            
            // Load stats
            loadProfileStats();
        })
        .catch(error => {
            console.error('Erro ao carregar perfil:', error);
        });
    
    // Set edit form values
    document.getElementById('editName').value = '';
    document.getElementById('editBio').value = '';
    document.getElementById('editLink').value = '';
}

// Load Profile Stats
function loadProfileStats() {
    const user = auth.currentUser;
    
    // Count posts
    db.collection('posts').where('user', '==', user.uid).get()
        .then(snapshot => {
            document.getElementById('profilePosts').innerText = snapshot.size;
        })
        .catch(error => {
            console.error('Erro ao carregar stats:', error);
        });
    
    // Set followers/following (mock data)
    document.getElementById('profileFollowers').innerText = '128';
    document.getElementById('profileFollowing').innerText = '56';
}

// Toggle Edit Profile
function toggleEditProfile() {
    const form = document.getElementById('editProfileForm');
    form.classList.toggle('hidden');
}

// Save Profile
function saveProfile() {
    const name = document.getElementById('editName').value;
    const bio = document.getElementById('editBio').value;
    const link = document.getElementById('editLink').value;
    
    db.collection('users').doc(auth.currentUser.uid).update({
        name: name,
        bio: bio,
        link: link
    })
    .then(() => {
        loadProfile();
        toggleEditProfile();
        alert('Perfil atualizado com sucesso!');
    })
    .catch(error => {
        console.error('Erro ao atualizar perfil:', error);
        alert('Erro ao atualizar perfil: ' + error.message);
    });
}

// Format Date
function formatDate(date) {
    if (!date) return 'Data desconhecida';
    
    let d;
    if (date && typeof date === 'object' && date.seconds) {
        d = new Date(date.seconds * 1000);
    } else if (date instanceof Date) {
        d = date;
    } else {
        return 'Data desconhecida';
    }
    
    const now = new Date();
    const diff = now - d;
    
    if (diff < 60000) return 'Agora mesmo';
    if (diff < 3600000) return `${Math.floor(diff / 60000)} minutos atr√°s`;
    if (diff < 86400000) return `${Math.floor(diff / 3600000)} horas atr√°s`;
    if (diff < 604800000) return `${Math.floor(diff / 86400000)} dias atr√°s`;
    
    return d.toLocaleDateString('pt-BR');
}

// Like Post
function likePost(postId) {
    const postRef = db.collection('posts').doc(postId);
    
    postRef.get().then(doc => {
        if (doc.exists) {
            const likes = (doc.data().likes || 0) + 1;
            postRef.update({ likes: likes });
        }
    }).catch(error => {
        console.error('Erro ao dar like:', error);
    });
}

// Comment Post
function commentPost(postId) {
    alert('Funcionalidade de coment√°rios em breve!');
}

// Share Post
function sharePost(postId) {
    alert('Funcionalidade de compartilhamento em breve!');
}
</script>
</body>
</html>
